povertymcs5, EPCLSI00, EPHOMS00, parentaldivorcemcs5, mEPALDR00, mEPFORC00, mEPDEAN00,
ECQ56X00, povertymcs6, FPCLSI00, FPHOMS00, parentaldivorcemcs6, mFPDRUG00, mFPFORC00,
mFPALDR00, mFPDEAN00, FCVICF0A, FCCYBU00, FCHURT00, accidentsinjuriesmcs1,
accidentsinjuriesmcs2, accidentsinjuriesmcs3, accidentsinjuriesmcs4, accidentsinjuriesmcs5,
accidentsinjuriesmcs6, conventionalcrimemcs6
) ~1
Model48.fit<-poLCA(alloriginals,data=data, nclass=1,na.rm=FALSE,nrep=30, maxiter=3000)
Model49b.fit<-poLCA(alloriginals,data=data, nclass=2,na.rm=FALSE,nrep=30, maxiter=3000)
Model49b.fit
Model49.fit
Model49.fit$aic
Model49b.fit$aic
Model57.fit<-poLCA(alloriginals,data=data, nclass=10,na.rm=FALSE,nrep=30, maxiter=3000)
#calculate entropy
set.seed(400)
entropy<-function (p) sum(-p*log(p))
error_prior<-entropy(Model48.fit$P) # class proportions model 1
error_post<-mean(apply(Model48.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass1<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model49.fit$P) # class proportions model 2
error_post<-mean(apply(Model49.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass2<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model48.fit$P) # class proportions model 1
error_post<-mean(apply(Model48.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass1<-round(((error_prior-error_post) / error_prior),3)
entropyclass1<-round(((error_prior-error_post) / error_prior),3)
error_prior-error_post
Model48.fit$P
entropy(Model48.fit$P)
error_prior<-entropy(Model49.fit$P) # class proportions model 2
error_post<-mean(apply(Model49.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass2<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model50.fit$P) # class proportions model 3
error_post<-mean(apply(Model50.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass3<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model51.fit$P) # class proportions model 4
error_post<-mean(apply(Model51.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass4<-round(((error_prior-error_post) / error_prior),3)
summary(Model51.fit)
Model51.fit
poLCA.entropy(Model49.fit)
poLCA.entropy(Model50.fit)
log(prod(sapply(Model49.fit$probs,ncol)))
poLCA.entropy(Model51.fit)
poLCA.entropy(Model52.fit)
poLCA.entropy(Model53.fit)
poLCA.entropy(Model54.fit)
#calculate entropy
set.seed(400)
entropy<-function (p) sum(-p*log(p))
error_prior<-entropy(Model48.fit$P) # class proportions model 1
error_post<-mean(apply(Model48.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass1<-round(((error_prior-error_post) / error_prior),3)
entropy()
View(entropy)
error_post<-mean(apply(Model49.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass2<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model49.fit$P) # class proportions model 2
error_post<-mean(apply(Model49.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass2<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model50.fit$P) # class proportions model 3
error_post<-mean(apply(Model50.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass3<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model51.fit$P) # class proportions model 4
error_post<-mean(apply(Model51.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass4<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model52.fit$P) # class proportions model 5
error_post<-mean(apply(Model52.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass5<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model53.fit$P) # class proportions model 6
error_post<-mean(apply(Model53.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass6<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model54.fit$P) # class proportions model 7
error_post<-mean(apply(Model54.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass7<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(Model55.fit$P) # class proportions model 8
error_post<-mean(apply(Model55.fit$posterior,1, entropy),na.rm = TRUE)
entropyclass8<-round(((error_prior-error_post) / error_prior),3)
#Lo, Mendell, Rubin test (LMRT)
install.packages('tidyLPA')
set.seed(400)
n <- Model48.fit$Nobs #number of observations (should be equal in all models)
#Lo, Mendell, Rubin test (LMRT)
install.packages('tidyLPA')
set.seed(400)
n <- Model48.fit$Nobs #number of observations (should be equal in all models)
n
class1loglikelihood <- Model48.fit$llik #log-likelihood
class1numparam <- Model48.fit$npar # number of parameters
class1numclasses <- length(Model48.fit$P) # number of classes
class2loglikelihood <- Model49.fit$llik #log-likelihood
class2numparam <- Model49.fit$npar # number of parameters
class2numclasses <- length(Model49.fit$P) # number of classes
#dataset allwaves_combined (7_9_2024).sav
#the association between cumulative score and delinquency
set.seed(400)
model1<-'
delinquencyaverage~cumulativeaverage2
cumulativeaverage2~~cumulativeaverage2'
set.seed(400)
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml')
library(lavaan)
#dataset allwaves_combined (7_9_2024).sav
#the association between cumulative score and delinquency
set.seed(400)
model1<-'
delinquencyaverage~cumulativeaverage2
cumulativeaverage2~~cumulativeaverage2'
set.seed(400)
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml')
# Summary of the results
summary(model1.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml')
model1b<-'
delinquencyaverage~cumulativeaverage2'
model1b.fit<-sem(model1b,
data=data,
estimator='ML',
missing='fiml')
model1<-'
delinquencyaverage~cumulativeaverage2'
set.seed(400)
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml')
model1<-'
delinquencyaverage~cumulativeaverage2
cumulativeaverage2~~cumulativeaverage2'
set.seed(400)
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml')
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml',
fixed.x=F)
model1<-'
delinquencyaverage~cumulativeaverage2'
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml',
fixed.x=F)
summary(model1.fit)
model1b.fit<-sem(model1b,
data=data,
estimator='ML',
missing='fiml',
fixed.x=F)
model1<-'
delinquencyaverage~cumulativeaverage2
cumulativeaverage2~~cumulativeaverage2'
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml',
fixed.x=F)
summary(model1b.fit)
summary(model1.fit)
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml')
summary(model1.fit)
summary(model1b.fit)
model1b<-'
delinquencyaverage~cumulativeaverage2'
set.seed(400)
model1b.fit<-sem(model1b,
data=data,
estimator='ML',
missing='fiml')
summary(model1b.fit)
model1b.fit<-sem(model1b,
data=data,
estimator='ML',
missing='fiml')
model1b.fit<-sem(model1b,
data=data,
estimator='ML',
missing='fiml',
fixed.x=F)
set.seed(400)
model1b.fit<-sem(model1b,
data=data,
estimator='ML',
missing='fiml',
fixed.x=F)
summary(model1b.fit)
model1.fit<-sem(model1,
data=data,
estimator='ML',
missing='fiml')
summary(model1.fit)
# Summary of the results
summary(model1.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
standardizedSolution(model1.fit, se = TRUE)
model3<-'
delinquencyaverage~cumuaverteen2+sexdummy+ethnicitydummy+EOECDUK0+relativestatusrecoded+mADACAQ00+ECQ23X00+REselfesteemmean+externalizingmcs62+FEMOTION+whethersmokingornot+drugusemcs6+FCALCN00
cumuaverteen2~~cumuaverteen2
sexdummy~~sexdummy
ethnicitydummy~~ethnicitydummy
EOECDUK0~~EOECDUK0
relativestatusrecoded~~relativestatusrecoded
mADACAQ00~~mADACAQ00
ECQ23X00~~ECQ23X00
REselfesteemmean~~REselfesteemmean
externalizingmcs62~~externalizingmcs62
FEMOTION~~FEMOTION
whethersmokingornot~~whethersmokingornot
drugusemcs6~~drugusemcs6
FCALCN00~~FCALCN00
cumuaverteen2~~sexdummy
cumuaverteen2~~EOECDUK0
cumuaverteen2~~relativestatusrecoded
cumuaverteen2~~mADACAQ00
cumuaverteen2~~ECQ23X00
cumuaverteen2~~externalizingmcs62
cumuaverteen2~~FEMOTION
cumuaverteen2~~REselfesteemmean
cumuaverteen2~~whethersmokingornot
cumuaverteen2~~drugusemcs6
cumuaverteen2~~FCALCN00
sexdummy~~relativestatusrecoded
sexdummy~~externalizingmcs62
sexdummy~~FEMOTION
sexdummy~~REselfesteemmean
ethnicitydummy~~EOECDUK0
ethnicitydummy~~relativestatusrecoded
ethnicitydummy~~ECQ23X00
ethnicitydummy~~externalizingmcs62
ethnicitydummy~~FEMOTION
ethnicitydummy~~REselfesteemmean
ethnicitydummy~~FCALCN00
ethnicitydummy~~whethersmokingornot
EOECDUK0~~relativestatusrecoded
EOECDUK0~~mADACAQ00
EOECDUK0~~ECQ23X00
EOECDUK0~~externalizingmcs62
EOECDUK0~~FEMOTION
EOECDUK0~~whethersmokingornot
EOECDUK0~~drugusemcs6
EOECDUK0~~FCALCN00
EOECDUK0~~REselfesteemmean
relativestatusrecoded~~mADACAQ00
relativestatusrecoded~~ECQ23X00
relativestatusrecoded~~FEMOTION
relativestatusrecoded~~REselfesteemmean
mADACAQ00~~ECQ23X00
mADACAQ00~~externalizingmcs62
mADACAQ00~~FEMOTION
mADACAQ00~~REselfesteemmean
mADACAQ00~~whethersmokingornot
ECQ23X00~~externalizingmcs62
ECQ23X00~~FEMOTION
ECQ23X00~~REselfesteemmean
ECQ23X00~~whethersmokingornot
ECQ23X00~~FCALCN00
externalizingmcs62~~FEMOTION
externalizingmcs62~~drugusemcs6
externalizingmcs62~~whethersmokingornot
externalizingmcs62~~FCALCN00
externalizingmcs62~~REselfesteemmean
FEMOTION~~drugusemcs6
FEMOTION~~whethersmokingornot
FEMOTION~~FCALCN00
FEMOTION~~REselfesteemmean
REselfesteemmean~~drugusemcs6
REselfesteemmean~~whethersmokingornot
REselfesteemmean~~FCALCN00
drugusemcs6~~whethersmokingornot
drugusemcs6~~FCALCN00
whethersmokingornot~~FCALCN00'
set.seed(400)
model3.fit<-sem(model3,
data=data,
estimator='ML',
missing='fiml')
model6<-'
delinquencyaverage~homelessnessacrosswaves
homelessnessacrosswaves~~homelessnessacrosswaves'
model6.fit<-sem(model6,
data=data,
estimator='MLR',
missing='fiml')
set.seed(400)
summary(model6.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
set.seed(400)
summary(model6.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
standardizedSolution(model6.fit, se = TRUE)
set.seed(400)
model7<-'
delinquencyaverage~parentalalcoholuseacrosswaves
parentalalcoholuseacrosswaves~~parentalalcoholuseacrosswaves'
model7.fit<-sem(model7,
data=data,
estimator='ML',
missing='fiml')
set.seed(400)
summary(model7.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
standardizedSolution(model7.fit, se = TRUE)
#now running analysis containing demographic information (single adversity approach)
set.seed(400)
model18<-'
delinquencyaverage~divorceacrosswaves+sexdummy+ethnicitydummy+EOECDUK0+relativestatusrecoded+mADACAQ00+ECQ23X00
divorceacrosswaves~~divorceacrosswaves
sexdummy~~sexdummy
ethnicitydummy~~ethnicitydummy
EOECDUK0~~EOECDUK0
relativestatusrecoded~~relativestatusrecoded
mADACAQ00~~mADACAQ00
ECQ23X00~~ECQ23X00
divorceacrosswaves~~ethnicitydummy
divorceacrosswaves~~EOECDUK0
divorceacrosswaves~~relativestatusrecoded
divorceacrosswaves~~mADACAQ00
divorceacrosswaves~~ECQ23X00
sexdummy~~relativestatusrecoded
ethnicitydummy~~EOECDUK0
ethnicitydummy~~relativestatusrecoded
ethnicitydummy~~ECQ23X00
EOECDUK0~~relativestatusrecoded
EOECDUK0~~mADACAQ00
EOECDUK0~~ECQ23X00
relativestatusrecoded~~mADACAQ00
relativestatusrecoded~~ECQ23X00
mADACAQ00~~ECQ23X00'
model18.fit<-sem(model18,
data=data,
estimator='ML',
missing='fiml')
set.seed(400)
summary(model18.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
standardizedSolution(model18.fit, se = TRUE)
# putting all adversities in one regression model (with only demographics)
set.seed(400)
model47<-
'delinquencyaverage~divorceacrosswaves+parentaldepressionacrosswaves+homelessnessacrosswaves+parentalalcoholuseacrosswaves+domesticviolenceacrosswaves+physicalpunishmentacrosswaves+accidentsinjuriesacrosswaves+povertyacrosswaves+longstandingillnessacrosswaves+peerbullyingacrosswaves+parentaldruguseacrosswaves+conventionalcrimemcs6+FCVICF0A+onlinebullyingmcs6+sexdummy+ethnicitydummy+EOECDUK0+relativestatusrecoded+mADACAQ00+ECQ23X00
divorceacrosswaves~~ divorceacrosswaves
parentaldepressionacrosswaves~~ parentaldepressionacrosswaves
homelessnessacrosswaves~~ homelessnessacrosswaves
parentalalcoholuseacrosswaves~~ parentalalcoholuseacrosswaves
domesticviolenceacrosswaves~~ domesticviolenceacrosswaves
physicalpunishmentacrosswaves~~ physicalpunishmentacrosswaves
accidentsinjuriesacrosswaves~~ accidentsinjuriesacrosswaves
povertyacrosswaves~~ povertyacrosswaves
longstandingillnessacrosswaves~~ longstandingillnessacrosswaves
peerbullyingacrosswaves~~ peerbullyingacrosswaves
parentaldruguseacrosswaves~~ parentaldruguseacrosswaves
conventionalcrimemcs6~~ conventionalcrimemcs6
FCVICF0A~~ FCVICF0A
onlinebullyingmcs6~~ onlinebullyingmcs6
sexdummy~~sexdummy
ethnicitydummy~~ethnicitydummy
EOECDUK0~~EOECDUK0
relativestatusrecoded~~relativestatusrecoded
mADACAQ00~~mADACAQ00
ECQ23X00~~ECQ23X00
divorceacrosswaves~~ longstandingillnessacrosswaves
divorceacrosswaves~~ povertyacrosswaves
divorceacrosswaves~~parentaldepressionacrosswaves
divorceacrosswaves~~accidentsinjuriesacrosswaves
divorceacrosswaves~~homelessnessacrosswaves
divorceacrosswaves~~povertyacrosswaves
divorceacrosswaves~~parentaldruguseacrosswaves
divorceacrosswaves~~domesticviolenceacrosswaves
divorceacrosswaves~~peerbullyingacrosswaves
divorceacrosswaves~~conventionalcrimemcs6
divorceacrosswaves~~ethnicitydummy
divorceacrosswaves~~EOECDUK0
divorceacrosswaves~~relativestatusrecoded
divorceacrosswaves~~mADACAQ00
divorceacrosswaves~~ECQ23X00
parentaldepressionacrosswaves~~ longstandingillnessacrosswaves
parentaldepressionacrosswaves~~ accidentsinjuriesacrosswaves
parentaldepressionacrosswaves~~ homelessnessacrosswaves
parentaldepressionacrosswaves~~ povertyacrosswaves
parentaldepressionacrosswaves~~ parentaldruguseacrosswaves
parentaldepressionacrosswaves~~ domesticviolenceacrosswaves
parentaldepressionacrosswaves~~ peerbullyingacrosswaves
parentaldepressionacrosswaves~~ physicalpunishmentacrosswaves
parentaldepressionacrosswaves~~ conventionalcrimemcs6
parentaldepressionacrosswaves~~ FCVICF0A
parentaldepressionacrosswaves~~ onlinebullyingmcs6
longstandingillnessacrosswaves~~ accidentsinjuriesacrosswaves
longstandingillnessacrosswaves~~ povertyacrosswaves
longstandingillnessacrosswaves~~ domesticviolenceacrosswaves
longstandingillnessacrosswaves~~ peerbullyingacrosswaves
longstandingillnessacrosswaves~~ conventionalcrimemcs6
longstandingillnessacrosswaves~~ FCVICF0A
longstandingillnessacrosswaves~~ onlinebullyingmcs6
accidentsinjuriesacrosswaves~~ homelessnessacrosswaves
accidentsinjuriesacrosswaves~~ povertyacrosswaves
accidentsinjuriesacrosswaves~~ peerbullyingacrosswaves
accidentsinjuriesacrosswaves~~ physicalpunishmentacrosswaves
accidentsinjuriesacrosswaves~~ conventionalcrimemcs6
accidentsinjuriesacrosswaves~~ onlinebullyingmcs6
homelessnessacrosswaves~~ povertyacrosswaves
homelessnessacrosswaves~~ parentaldruguseacrosswaves
homelessnessacrosswaves~~ parentalalcoholuseacrosswaves
homelessnessacrosswaves~~ domesticviolenceacrosswaves
homelessnessacrosswaves~~ physicalpunishmentacrosswaves
homelessnessacrosswaves~~ conventionalcrimemcs6
povertyacrosswaves~~ parentaldruguseacrosswaves
povertyacrosswaves~~ parentalalcoholuseacrosswaves
povertyacrosswaves~~ domesticviolenceacrosswaves
povertyacrosswaves~~ physicalpunishmentacrosswaves
parentaldruguseacrosswaves~~ parentalalcoholuseacrosswaves
parentaldruguseacrosswaves~~ domesticviolenceacrosswaves
parentaldruguseacrosswaves~~ peerbullyingacrosswaves
parentaldruguseacrosswaves~~ conventionalcrimemcs6
parentaldruguseacrosswaves~~ onlinebullyingmcs6
parentalalcoholuseacrosswaves~~ physicalpunishmentacrosswaves
parentalalcoholuseacrosswaves~~ conventionalcrimemcs6
parentalalcoholuseacrosswaves~~ onlinebullyingmcs6
domesticviolenceacrosswaves~~ physicalpunishmentacrosswaves
domesticviolenceacrosswaves~~ conventionalcrimemcs6
domesticviolenceacrosswaves~~ FCVICF0A
peerbullyingacrosswaves~~ physicalpunishmentacrosswaves
peerbullyingacrosswaves~~ conventionalcrimemcs6
peerbullyingacrosswaves~~ FCVICF0A
peerbullyingacrosswaves~~ onlinebullyingmcs6
physicalpunishmentacrosswaves~~ conventionalcrimemcs6
conventionalcrimemcs6~~ FCVICF0A
conventionalcrimemcs6~~ onlinebullyingmcs6
FCVICF0A~~ onlinebullyingmcs6
parentaldepressionacrosswaves~~ethnicitydummy
parentaldepressionacrosswaves~~EOECDUK0
parentaldepressionacrosswaves~~relativestatusrecoded
parentaldepressionacrosswaves~~mADACAQ00
homelessnessacrosswaves~~ethnicitydummy
homelessnessacrosswaves~~EOECDUK0
homelessnessacrosswaves~~relativestatusrecoded
homelessnessacrosswaves~~mADACAQ00
homelessnessacrosswaves~~ECQ23X00
parentalalcoholuseacrosswaves~~ethnicitydummy
parentalalcoholuseacrosswaves~~EOECDUK0
parentalalcoholuseacrosswaves~~mADACAQ00
parentalalcoholuseacrosswaves~~ECQ23X00
domesticviolenceacrosswaves~~ethnicitydummy
domesticviolenceacrosswaves~~EOECDUK0
physicalpunishmentacrosswaves~~sexdummy
physicalpunishmentacrosswaves~~EOECDUK0
physicalpunishmentacrosswaves~~mADACAQ00
physicalpunishmentacrosswaves~~ECQ23X00
accidentsinjuriesacrosswaves~~sexdummy
accidentsinjuriesacrosswaves~~ethnicitydummy
accidentsinjuriesacrosswaves~~EOECDUK0
povertyacrosswaves~~ethnicitydummy
povertyacrosswaves~~EOECDUK0
povertyacrosswaves~~relativestatusrecoded
povertyacrosswaves~~mADACAQ00
povertyacrosswaves~~ECQ23X00
longstandingillnessacrosswaves~~sexdummy
longstandingillnessacrosswaves~~ethnicitydummy
longstandingillnessacrosswaves~~EOECDUK0
longstandingillnessacrosswaves~~mADACAQ00
longstandingillnessacrosswaves~~ECQ23X00
peerbullyingacrosswaves~~sexdummy
peerbullyingacrosswaves~~ethnicitydummy
peerbullyingacrosswaves~~ECQ23X00
parentaldruguseacrosswaves~~EOECDUK0
parentaldruguseacrosswaves~~relativestatusrecoded
parentaldruguseacrosswaves~~mADACAQ00
conventionalcrimemcs6~~sexdummy
conventionalcrimemcs6~~ethnicitydummy
conventionalcrimemcs6~~relativestatusrecoded
conventionalcrimemcs6~~ECQ23X00
FCVICF0A~~sexdummy
FCVICF0A~~mADACAQ00
FCVICF0A~~ECQ23X00
onlinebullyingmcs6~~sexdummy
onlinebullyingmcs6~~ethnicitydummy
sexdummy~~relativestatusrecoded
ethnicitydummy~~EOECDUK0
ethnicitydummy~~relativestatusrecoded
ethnicitydummy~~ECQ23X00
EOECDUK0~~relativestatusrecoded
EOECDUK0~~mADACAQ00
EOECDUK0~~ECQ23X00
relativestatusrecoded~~mADACAQ00
relativestatusrecoded~~ECQ23X00
mADACAQ00~~ECQ23X00'
set.seed(400)
model47.fit<-sem(model47,
data=data,
estimator='ML',
missing='fiml')
summary(model47.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
standardizedSolution(model47.fit, se = TRUE)
summary(model47.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
summary(lm(delinquencyaverage ~ factor(categoricalcumulative), data))
data$cumulativeaverage
data$cumulativeaverage2
head(data$cumulativeaverage)
head(data$cumulativeaverage2)
data$cumulativeaverageNL <- data$cumulativeaverage^2
summary(lm(delinquencyaverage ~ cumulativeaverage+cumulativeaverageNL, dat))
summary(lm(delinquencyaverage ~ cumulativeaverage+cumulativeaverageNL, data))
ggplot(data, aes(cumulativeaverage, delinquencyaverage)) + geom_point() + geom_smooth(method = 'lm')
