---
title: "Week 8: Regression I"
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
    css: https://mtruelovehill.github.io/PRM/Labs/css/style.css
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
library(kableExtra)
# library(knitr)
# library(shiny)
# library(shinyjs)
# library(bslib)

baseColor <- '#4CA384'
accent1 <- '#9AD079'
accent2 <- '#C4C6C7'
accent3 <- '#19424C'
```

```{r, context = 'server'}
# output$regPlot <- renderPlot({
#   set.seed(1022)
#   
#   dat <- data.frame(X=rnorm(300, mean = input$mean, sd = input$sd))
#       
#   ggplot(data.frame(X = c(-30, 30)), aes(x = X)) +
#     geom_histogram(data=dat, aes(x=X, y = after_stat(density)), fill = '#4CA384', color = '#19424C',
#                        binwidth = 2) +
#         stat_function(fun=dnorm, geom = "line", args = list(mean = input$mean, sd = input$sd),
#                       linewidth = 1, color = '#19424C') +
#         scale_x_continuous(breaks = seq(-30, 30, 10), limits=c(-30, 30)) +
#         scale_y_continuous(limits=c(0, .4)) +
#         theme(axis.title.x = element_text(size = 16, face = 'bold'),
#               axis.text.x = element_text(size = 16),
#               axis.line.y = element_blank(),
#               axis.text.y = element_blank(),
#               axis.ticks = element_blank(),
#               axis.title.y = element_blank())
#     }, height = 300)
```

## Intro to Today's Lab

During today's lab, you'll apply the concepts discussed during this week's lecture. Each lab consists of a range of tasks, with corresponding questions you can answer. Please note that the questions are not required and not marked, although they do provide a helpful source of formative feedback that will help you gauge your understanding. 

### Learning Objectives
At the end of this lab, you will be able to:

1. Understand what is meant by 'intercept' and 'slope'
2. Identify hypotheses which may be tested using regression
3. Test the assumptions of a regression
4. Use SPSS to run multiple linear regression
5. Properly interpret and report multiple linear regression analysis
6. Run a power analysis for linear regression


## Task 1: Introduction to Regression

MONICA: Include a plot that can be adapted to show the effect of changing the slope and the intercept.


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Goes Here

</details>
</div>
</br>

<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution Goes Here

</details>
</div>
</br>

## Experiment Overview

<br>
You'll be working with data adapted from [this study](https://www.tandfonline.com/doi/pdf/10.1080/19496591.2016.1157488?casa_token=KqqNSiTRoRsAAAAA:QhO9mJDVherxFrqUfdQhgLIeqbccw9HNTyB0Z3Ef3lQOKjmw6UPAETyUw6HBoC_XhIhf9rnytNmk) in which the researchers investigated the factors associated with well-being in University students. 

In this experiment, you recruited a sample of university students and administered several scales to capture your variables of interest. Specifically, you measured participants' well-being, their level of social support, their weekly physical activity, and their sleep per week. On each variable, higher scores correspond to higher levels.

You can download the dataset from this experiment [here](https://mtruelovehill.github.io/PRM/Labs/Week8LabData.sav). It contains the following variables:

```{r, echo = F}
#dat <- read.csv('https://mtruelovehill.github.io/PRM/Labs/Week8LabData.csv')
dat <- read.csv('Week8LabData.csv')
datInfo <- data.frame(VariableName = colnames(dat),
                      Description=c('Age in years',
                                    'Levels: Female; Male; Nonbinary; Other; Prefer not to Disclose',
                                    'Amount of physical activity per week in hours',
                                    'Amount of sleep per week in hours',
                                    'Scores on a social support scale; values may range between 0-45',
                                    'Scores on a well-being scale; values may range between 0-40'))

datInfo %>%
  kbl(col.names=c('Variable Name', 'Description')) %>%
  kable_styling(full_width = F) %>%
  row_spec(0, bold = T, color=baseColor, font_size = 18, align='l') %>%
  column_spec(1, bold = T, width = '4.5cm')
```

You'll be investigating whether physical activity, sleep, and social support predict students' wellbeing. 

```{r cyu1, echo = FALSE}
quiz(caption = '',
     question("Which test is most appropriate to address your research question, given the study design?",
              answer("Simple Linear Regression"),
              answer("Factorial ANOVA"),
              answer("Pearson Correlation"),
              answer("Multiple Linear Regression", correct = T),
              message = "Here, you're looking at whether several continuous variables predict values on another continuous variables. Both a t-test and a Factorial ANOVA require a categorical dependent variable, and a Pearson correlation only looks at the association between two continuous variables. A simple linear regression is one in which a single variable predicts an outcome, and here there are 3 predictors. In this case, multiple linear regression is the best option."),
     question("Which of the following questions can be addressed using linear regression? Please select all that apply.",
              answer('What is the association between age in years and weight in kg?', correct = T),
              answer('Is there a difference in vaping rates by age group?', correct = T),
              answer('Is there an association between season (Spring, Summer, Autumn, Winter) and the number of cyclists on the path through the Meadows?', correct = T),
              answer('Are scores on the Beck Depression Inventory associated with weekly physical activity (in hours)?', correct = T),
              answer('Can scores on a standardised test predict University marks?', correct = T),
              answer('Can the number of sweets one consumes per month predict the presence or absence of tooth decay?'),
              random_answer_order = T,
              message = "Linear regression can actually address almost all of these questions. It's super flexible! In SPSS, however, it's a bit more complex to do regression analyses with categorical predictors, so in this course, we've been using ANOVA. The only research question that cannot be tested with linear regression is 'Can the number of sweets one consumes per month predict the presence or absence of tooth decay?', as this has a binary outcome variable (Tooth Decay: Yes/No). In the case of binary outcomes, a linear model is not appropriate; instead, you should use logistic regression."))
```

### Your Tasks
+ [ ] $\ $ Specify the predictor and outcome variables.
+ [ ] $\ $ State your research question(s) for this experiment.
+ [ ] $\ $ State your hypotheses for this experiment, both using words and statistically.


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

With regression, it's common to refer to variables as predictors and outcomes rather than independent and dependent variables. However, the predictor variables equate to the independent variables, and the outcome equates to the dependent variable.

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

<b>Possible Research Questions:</b>

Do physical activity, sleep, and social support significantly predict well-being in university students? 

<br>

<b>Predictors:</b> Physical Activity; Sleep; Social Support 

<b>Variable 2:</b> Well-being

<br>

<b>Hypotheses:</b>

<i> General: </i>

Here is an example of the overall hypothesis: 

$H_0:$ Sleep, physical activity, and social support do not predict well-being in university students.

$H_1:$ Sleep, physical activity, and social support significantly predict well-being in university students.


Here is an example of a specific hypothesis:

$H_0:$ Sleep does not predict well-being in university students when controlling for the effects of physical activity and social support.

$H_1:$ Sleep predicts well-being in university students when controlling for the effects of physical activity and social support.

<i> Statistical: </i>

$H_0: \beta_{x_i} = 0$

$H_1: \beta_{x_i} \neq 0$

</details>
</div>
</br>


## Task 3: 


Task Description Here

<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Here

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution here.

</details>
</div>
</br>




## Task 4: 

Task Here.

```{r q4, echo = FALSE}
# quiz(caption = 'Test Your Understanding',
#      question("At least one of the groups is limited in size compared to the others",
#               answer("True", correct = T),
#               answer("False"),
#               message = 'The nonbinary group is much smaller than the other two measured groups.'),
#      question_numeric("How many total datapoints do you have for the gender variable?",
#               answer(48, correct=T)),
#      question_numeric("What percentage of participants are female?",
#               answer(41.7, correct=T)),
#      question_numeric('How many nonbinary participants are in your sample?',
#               answer(2, correct=T)))
```

<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Here

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution here.

</details>
</div>
</br>

## Task 5: 

Task Here

<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Here

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution here.

</details>
</div>
</br>

## Task 6: 

Task Description.

```{r q6, echo = FALSE}
# quiz(caption = 'Test Your Understanding',
#      question("Which of the following central tendency measures could be used to describe age? Please select all that apply.",
#               answer("Mean", correct = T),
#               answer("Median", correct = T),
#               answer('Mode', correct = T),
#               message = 'All of the above could technically be used to describe the Age variable. However, it is most common to use the
#               mean, as it includes information from each observation.'),
#      question("Which of the following central tendency measures could be used to describe gender? Please select all that apply.",
#               answer("Mean"),
#               answer("Median"),
#               answer('Mode', correct = T),
#               message = 'As a categorical variable, there is no numeric relationship between values in the gender variable. Therefore, 
#               the mode is the only measure of central tendency that is appropriate to describe this variable'),
#      question_numeric("What is the average score on Assessment A?",
#               answer(39.10, correct=T)),
#      question_numeric("What is the most common age in this sample?",
#               answer(19, correct=T)),
#      question_numeric("What is the median score on Assessment D?",
#               answer(81.87, correct=T))
# )
```

<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Here

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution here.

</details>
</div>
</br>

## Task 7: 

Task here.

```{r q7, echo = FALSE}
# quiz(caption = 'Test Your Understanding',
#      question_numeric("What is the IQR for Assessment B?",
#               answer(4, correct=T),
#               message = "To get the IQR for a variable, you'll need to subtract the 25th percentile from the 75th percentile."),
#      question_numeric("What is the maximum score on Assessment C?",
#               answer(78, correct=T)),
#      question_numeric("What is the standard deviation of scores on Assessment D? Please report your answer to two decimal places.",
#               answer(2.15, correct=T))
# )
```

<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Here

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution here.

</details>
</div>
</br>

## Task 8: 

Task here.

```{r distPlot, echo = F}
# 
# fluidRow(column(4, 
#   sliderInput("mean","Value of Mean:", min = -6, max = 6, value = 0, step = 2),
#   sliderInput('sd', 'Value of SD:', min = 1, max = 5, value = 1, step = .25)),
#   column(8, plotOutput('distPlot')))
# 
# tags$style(HTML(".js-irs-0 .irs-single, .js-irs-0 .irs-bar-edge, .js-irs-0 .irs-bar {background: #4CA384}"))
# tags$style(HTML(".js-irs-1 .irs-single, .js-irs-1 .irs-bar-edge, .js-irs-1 .irs-bar {background: #4CA384}"))

```

<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Here

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution here.

</details>
</div>
</br>


## Task 9

Task here.

<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Here

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution here.

</details>
</div>
</br>


## Interpret & Report 

Task here.


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for a hint </span></summary>

Hint Here

</details>
</div>
</br>


<div class="container">
<details><summary><span style = "font-weight: bold; font-size: 16pt"> Click here for the solution </span></summary>

Solution here.

</details>
</div>
</br>

